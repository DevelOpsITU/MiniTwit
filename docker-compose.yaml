version: '3'
services:


  minitwit-go:
    container_name: minitwit-go
    image: minitwit-go:latest
    build: .
    environment:
      - SERVER_HOST=localhost
      - DB_CONNECTION_STRING=/tmp/minitwit.db
    ports:
      - 8080:8080
    volumes:
      - ../data/:/tmp/
    depends_on:
      - grafana
      - prometheus


  prometheus:
    image: prom/prometheus
    container_name: prometheus
    volumes:
      - ./prometheus.yml:/etc/prometheus/prometheus.yml
    ports:
      - "9090:9090"


  grafana:
    build:
      context: ./grafana
    ports:
      - "3000:3000"
    volumes:
      - grafana-data:/var/lib/grafana

# Explicitly define the persistent volume for your data storage
volumes:
  grafana-data:
